/* Print/PDF-specific styles to fix spacing issues */
@media print {
    /* Reset viewport-based units to fixed units for PDF */

    /* Base slide structure */
    .slide {
        width: 100% !important;
        height: 100vh !important;
        page-break-after: always !important;
        page-break-inside: avoid !important;
        position: relative !important;
    }

    .slide-header {
        height: 60px !important;
        padding: 15px 30px !important;
    }

    .slide-title {
        font-size: 24px !important;
    }

    .slide-content {
        padding: 10px 30px !important;
        gap: 8px !important;
        height: calc(100vh - 120px) !important;
    }

    .slide-footer {
        position: absolute !important;
        bottom: 0.25in !important;
        left: 0.25in !important;
        right: 0.25in !important;
        margin-top: 0 !important;
        padding-top: 0.5rem !important;
        width: auto !important;
        z-index: 10 !important;
        background-color: white !important;
        font-size: 11px !important;  /* Match the base style */
        height: 40px !important;  /* Fixed height */
        align-items: center !important;  /* Center vertically */
        display: flex !important;  /* Ensure flex display */
    }

    /* Timeline specific fixes */
    .timeline-horizontal {
        padding-bottom: 50px !important;
    }

    .timeline-node-year {
        font-size: 11px !important;
    }

    .timeline-node-title {
        font-size: 13px !important;
    }

    .timeline-node-detail {
        font-size: 11px !important;
    }

    /* Section titles */
    .section-title {
        font-size: 13px !important;
        margin-bottom: 8px !important;
    }

    /* Content sections */
    .content-section {
        margin: 0 !important;
    }

    /* Cards and containers */
    div[style*="border-radius: 12px"] {
        padding: 12px !important;
        margin-bottom: 8px !important;
    }

    div[style*="border-radius: 8px"] {
        padding: 8px !important;
    }

    /* Typography fixes */
    h1 {
        font-size: 24px !important;
    }

    h2 {
        font-size: 18px !important;
    }

    h3 {
        font-size: 14px !important;
        margin-bottom: 8px !important;
    }

    h4 {
        font-size: 12px !important;
        margin-bottom: 6px !important;
    }

    p, li {
        font-size: 12px !important;
        line-height: 1.4 !important;
    }

    /* Replace all min() functions with fixed values */
    [style*="gap: min"] {
        gap: 8px !important;
    }

    [style*="padding: min"] {
        padding: 10px !important;
    }

    [style*="margin: min"] {
        margin: 8px !important;
    }

    [style*="margin-bottom: min"] {
        margin-bottom: 8px !important;
    }

    /* Font size replacements for clamp() functions */
    [style*="font-size: clamp(0.5rem"] {
        font-size: 9px !important;
    }

    [style*="font-size: clamp(0.55rem"] {
        font-size: 10px !important;
    }

    [style*="font-size: clamp(0.6rem"] {
        font-size: 10px !important;
    }

    [style*="font-size: clamp(0.65rem"] {
        font-size: 11px !important;
    }

    [style*="font-size: clamp(0.7rem"] {
        font-size: 12px !important;
    }

    [style*="font-size: clamp(0.75rem"] {
        font-size: 12px !important;
    }

    [style*="font-size: clamp(0.8rem"] {
        font-size: 12px !important;
    }

    [style*="font-size: clamp(0.85rem"] {
        font-size: 13px !important;
    }

    [style*="font-size: clamp(0.9rem"] {
        font-size: 13px !important;
    }

    [style*="font-size: clamp(0.95rem"] {
        font-size: 14px !important;
    }

    [style*="font-size: clamp(1rem"] {
        font-size: 14px !important;
    }

    [style*="font-size: clamp(1.1rem"] {
        font-size: 16px !important;
    }

    [style*="font-size: clamp(1.25rem"] {
        font-size: 18px !important;
    }

    [style*="font-size: clamp(1.5rem"] {
        font-size: 20px !important;
    }

    [style*="font-size: clamp(1.75rem"] {
        font-size: 22px !important;
    }

    [style*="font-size: clamp(2rem"] {
        font-size: 24px !important;
    }

    /* Specific fixes for slide 1 */
    #slide-1 .slide-content {
        padding: 0 30px 4px 30px !important;
        gap: 2px !important;  /* Reduced from 4px */
        height: calc(100vh - 130px) !important;
        justify-content: flex-start !important;
    }

    #slide-1 .timeline-horizontal {
        margin: 0 0 40px 0 !important;  /* Add bottom margin for separation */
        padding: 15px 0 35px 0 !important;
    }

    #slide-1 .timeline-horizontal::before {
        top: 33px !important;  /* Moved down for better alignment in print */
        z-index: 0 !important;
    }

    #slide-1 .timeline-circle {
        position: relative !important;
        z-index: 2 !important;
        background: white !important;  /* White background to cover line */
        width: 40px !important;
        height: 40px !important;
    }

    /* Keep the last circle (APEX/Next Step) filled */
    #slide-1 .timeline-node.next .timeline-circle {
        background: var(--accent-primary) !important;
        color: white !important;
    }

    /* More specific selectors to override inline styles */
    #slide-1 .slide-content > .content-section:first-of-type {
        margin-top: 0 !important;  /* Timeline margin-bottom handles spacing */
        margin-bottom: 4px !important;
    }

    #slide-1 .slide-content > .content-section:nth-of-type(2) {
        margin-top: 4px !important;
        margin-bottom: 4px !important;
    }

    #slide-1 .slide-content > .content-section {
        margin-bottom: 4px !important;
    }

    /* Reduce grid gaps */
    #slide-1 .content-section div[style*="display: grid"] {
        gap: 3px !important;  /* Reduced from 4px */
    }

    /* Reduce padding in achievement boxes */
    #slide-1 div[style*="border-radius: 10px"] {
        padding: 5px 7px !important;  /* Slightly tighter */
    }

    /* Reduce padding in project boxes */
    #slide-1 div[style*="border-left: 3px solid"] {
        padding: 5px !important;
    }

    /* Section titles - even larger for readability */
    #slide-1 .section-title {
        font-size: 13px !important;  /* Increased from 12px */
        margin-bottom: 3px !important;
        font-weight: 700 !important;
    }

    /* Match slide-05 font sizes for better readability */
    #slide-1 ul {
        margin: 0 !important;
        padding: 0 !important;
    }

    #slide-1 ul li {
        font-size: 12px !important;  /* Matches clamp(0.75rem, 1.5vh, 0.95rem) from slide-05 */
        line-height: 1.4 !important;  /* Match slide-05 line-height */
        margin-bottom: 1px !important;
    }

    #slide-1 h3 {
        font-size: 13px !important;
        margin-bottom: 2px !important;
    }

    #slide-1 h4 {
        font-size: 12px !important;
        margin-bottom: 2px !important;
    }

    #slide-1 p {
        font-size: 12px !important;  /* Matches clamp(0.75rem, 1.5vh, 0.95rem) from slide-05 */
        line-height: 1.4 !important;  /* Match slide-05 line-height */
    }

    /* Fix timeline logo sizes in print - override inline styles */
    #slide-1 .timeline-node img[alt*="Logo"][style] {
        bottom: -45px !important;
        width: 50px !important;
        height: 50px !important;
    }

    /* Specific logo size adjustments - override inline styles */
    #slide-1 .timeline-node-content img[alt="Princeton Logo"][style] {
        width: 42px !important;
        height: 42px !important;
        bottom: -65px !important;  /* Space between text and logo */
    }

    /* Keep Princeton text at same vertical level as other timeline events */
    #slide-1 .timeline-node:first-child .timeline-node-content {
        min-height: 55px !important;  /* Align text with other timeline events */
    }

    #slide-1 .timeline-node-content img[alt="Point72 Logo"][style] {
        width: 80px !important;
        height: 80px !important;
        bottom: -60px !important;  /* Lower to align with 101st logos */
        left: 46% !important;  /* Shifted left from center */
        transform: translateX(-50%) !important;
    }

    /* Center Apex logo vertically in header for all slides */
    .apex-logo-corner {
        top: 10px !important;  /* Positioned for visual centering in header */
        width: 110px !important;
        height: auto !important;
    }

    /* Ensure Apex logo is not affected on slide 1 specifically */
    #slide-1 .apex-logo-corner {
        width: 110px !important;
        height: auto !important;
    }

    /* Mission/Career boxes on slide 1 - more readable */
    #slide-1 div[style*="MISSION FOCUS"],
    #slide-1 div[style*="CAREER DRIVE"] {
        padding: 4px 5px !important;
    }

    /* Make Mission/Career box text match slide-05 size */
    #slide-1 div[style*="MISSION FOCUS"] div,
    #slide-1 div[style*="CAREER DRIVE"] div,
    #slide-1 div[style*="font-size: clamp(0.55rem"] {
        font-size: 12px !important;  /* Match slide-05 CORE RESPONSIBILITIES body text */
        line-height: 1.4 !important;
    }

    /* Reduce spacing above Mission/Career section */
    #slide-1 > div[style*="display: flex"][style*="gap: 4px"] {
        margin-top: 2px !important;
        gap: 3px !important;
    }

    /* Make icon circles slightly larger to match bigger text */
    #slide-1 span[style*="border-radius: 50%"] {
        font-size: 0.65rem !important;
        min-width: 22px !important;
        min-height: 22px !important;
        width: 22px !important;
        height: 22px !important;
    }

    /* NUCLEAR OVERRIDE: Force ALL font sizes in content-section containers */
    #slide-1 .content-section * {
        font-size: inherit !important;
    }

    /* Set base size for content-section containers */
    #slide-1 .content-section {
        font-size: 12px !important;  /* Match slide-05 CORE RESPONSIBILITIES (clamp(0.75rem, 1.5vh, 0.95rem) = 12px in print) */
    }

    /* Specific overrides for headers in content-section */
    #slide-1 .content-section h3 {
        font-size: 13px !important;
    }

    #slide-1 .content-section h4 {
        font-size: 12px !important;
    }

    #slide-1 .content-section .section-title {
        font-size: 14px !important;
    }

    /* Force all lists and paragraphs in content-section - overrides inline styles */
    #slide-1 .content-section ul,
    #slide-1 .content-section ul li,
    #slide-1 .content-section p,
    #slide-1 ul[style*="font-size: 0.7rem"],
    #slide-1 ul[style*="font-size: 0.7rem"] li,
    #slide-1 p[style*="font-size: clamp(0.7rem"] {
        font-size: 12px !important;  /* Match slide-05 CORE RESPONSIBILITIES body text */
        line-height: 1.4 !important;  /* Match slide-05 line-height */
    }

    /* Ensure footer doesn't overlap */
    /* Remove or comment this out:
    #slide-1 .slide-footer {
        position: absolute !important;
        bottom: 0 !important;
        left: 0 !important;
        right: 0 !important;
    }
    */

    /* Hide overflow */
    * {
        overflow: visible !important;
    }

    /* Ensure no scrollbars */
    .slide-content {
        overflow: hidden !important;
    }

    /* Updated slide 2 fixes in styles-print.css */
    #slide-2 .slide-content {
        grid-template-columns: 55% 45% !important;  /* More space for photo column */
        gap: 1rem !important;
        padding: 1.5rem 2.5rem !important;  /* More horizontal padding for centering */
        align-items: center !important;  /* Center vertically */
        justify-content: center !important;  /* Center horizontally */
    }

    /* Much larger photo */
    #slide-2 figure img {
        height: 320px !important;  /* Even larger fixed height */
        max-height: none !important;
        object-fit: contain !important;
    }

    /* Polish text sizes for print readability */
    #slide-2 .slide-title {
        font-size: 1.2rem !important;
    }

    #slide-2 ul {
        font-size: 10px !important;
        line-height: 1.3 !important;
    }

    /* Ensure smaller metric numbers but still readable */
    #slide-2 div[style*="font-size: 1rem"] {
        font-size: 0.95rem !important;
        font-weight: 800 !important;
    }

    /* Specific fixes for slide 4 - Atlantic Resolve */
    #slide-4 svg {
        display: none !important;  /* Hide SVG connectors */
    }

    #slide-4 div[style*="position: absolute"][style*="right: -15px"] {
        display: none !important;  /* Hide absolute arrow */
    }

    /* Tighten cascading cards - override general border-radius rules */
    #slide-4 div[style*="border-radius: 12px"][style*="margin-bottom: -10px"] {
        margin-bottom: 0.25rem !important;  /* Tighter vertical spacing */
        padding: 0.5rem !important;  /* Tighter internal padding */
    }

    #slide-4 div[style*="background: #f8fafc"][style*="border-radius: 12px"] {
        margin-left: 5px !important;  /* Card 2 (Actions) tighter */
        margin-bottom: 0.25rem !important;
        padding: 0.5rem !important;  /* Tighter internal padding */
    }

    #slide-4 div[style*="margin-left: 40px"][style*="border-radius: 12px"] {
        margin-left: 10px !important;  /* Card 3 (Results) tighter */
        margin-bottom: 0.25rem !important;
        padding: 0.45rem !important;  /* Even tighter for last card */
        box-shadow: 0 6px 20px rgba(0,0,0,0.08) !important;  /* Match Card 2 shadow */
    }

    /* Tighten padding in Daily RAG Snapshot container */
    #slide-4 div[style*="Daily RAG Snapshot"] {
        padding: 0.5rem !important;
    }

    #slide-4 table th,
    #slide-4 table td {
        padding: 0.25rem !important;
    }

    /* Specific fixes for slide 6 - P72 AI Initiative */
    /* Add border to main narrative container to match other containers */
    #slide-6 section > div:first-child {
        border: 1px solid #dee2e6 !important;
    }

    /* Reduce Impact section height to prevent Implementation Architecture overflow */
    #slide-6 div[style*="linear-gradient(135deg, #059669, #047857)"] {
        padding: 0.35rem 0.5rem !important;  /* Much tighter vertical padding */
    }

    #slide-6 div[style*="linear-gradient(135deg, #059669, #047857)"] h4 {
        margin-bottom: 0.2rem !important;  /* Even tighter spacing */
        font-size: 0.7rem !important;  /* Smaller heading */
    }

    /* Reduce large metric numbers */
    #slide-6 div[style*="linear-gradient(135deg, #059669, #047857)"] span[style*="font-size: clamp(1.75rem"] {
        font-size: 1.1rem !important;  /* Smaller metrics */
        line-height: 1 !important;
    }

    /* Reduce metric labels */
    #slide-6 div[style*="linear-gradient(135deg, #059669, #047857)"] span[style*="font-size: clamp(0.65rem"] {
        font-size: 0.55rem !important;  /* Smaller labels */
    }

    /* Reduce metric box padding */
    #slide-6 div[style*="linear-gradient(135deg, #059669, #047857)"] div[style*="background: rgba(255,255,255,0.1)"] {
        padding: 0.3rem 0.4rem !important;  /* Much tighter padding */
    }

    /* Specific fixes for slide 3 - GCSS-Army */
    #slide-3 .slide-content {
        align-items: stretch !important;
        gap: 0 !important;
        padding-top: 0 !important;
        justify-content: flex-start !important;
    }

    /* Reduce spacing between SAP badge and content on Slide 3 */
    #slide-3 .slide-content > div:nth-child(2) {
        margin: 0 0 0.1rem 0 !important; /* override all margins, minimal bottom gap */
        justify-content: center !important;
    }

    /* Tighten the badge itself */
    #slide-3 .slide-content > div:nth-child(2) span {
        margin: 0 !important;
        padding: 1px 3px !important; /* smaller padding inside the badge */
    }

    /* Also ensure no extra top margin on the grid that follows */
    #slide-3 .slide-content > div:nth-child(3) {
        margin-top: 0 !important;
    }

    /* Grid adjustments for better spacing */
    #slide-3 .slide-content > div:last-child {
        grid-template-columns: 0.48fr 0.52fr !important;
        align-items: center !important;
        place-items: center !important;
        margin-top: 0 !important;
        padding-top: 0 !important;
    }

    /* Target the left column flex container to reduce gap */
    #slide-3 .slide-content > div:last-child > div:first-child {
        gap: 0.75rem !important;
    }

    /* Ensure both columns wrap content and don't stretch */
    #slide-3 .slide-content > div:last-child > div {
        height: fit-content !important;
    }

    /* Ensure the screenshot container wraps content */
    #slide-3 div[style*="background: white"][style*="border-radius: 12px"] {
        display: flex !important;
        flex-direction: column !important;
        height: fit-content !important;
        align-self: center !important;
    }

    #slide-3 div[style*="position: relative"][style*="flex: 0"] {
        flex: 0 0 auto !important;
        height: auto !important;
    }

    /* Prevent text wrapping in workflow bar */
    #slide-3 div[style*="background: #f57c00"] {
        white-space: nowrap !important;
        padding: 0 4px !important; /* Add small padding */
    }

    /* Removed problematic image height rules - let image size naturally */
    /*
    #slide-3 img {
        height: auto !important;
        min-height: 300px !important;
        max-height: 400px !important;
    }
    */

    /* Fix floating stats position in print */
    #slide-3 div[style*="position: absolute"][style*="bottom: 10px"] {
        bottom: 15px !important;
        left: 15px !important;
        font-size: 10px !important;
    }

    /* Ensure workflow percentages are bold in print */
    #slide-3 div[style*="background: #1976d2"],
    #slide-3 div[style*="background: #388e3c"],
    #slide-3 div[style*="background: #f57c00"] {
        font-weight: 700 !important;
    }

    /* Specific fixes for slide 8 - Ready to Contribute */
    #slide-8 .slide-content {
        padding: 0.5rem 1.5rem !important;
        gap: 0.4rem !important;
        justify-content: space-between !important;
        height: calc(100vh - 100px) !important;
    }

    #slide-8 section {
        flex: 0 1 auto !important;
        max-height: 58% !important;  /* Increased from 50% to fit all content */
        overflow: hidden !important;
        padding: 0.75vh 0.85rem !important;  /* Tighter padding */
    }

    /* Reduce section heading */
    #slide-8 section h3 {
        font-size: 0.85rem !important;  /* Smaller heading */
        margin-bottom: 0.6rem !important;  /* Tighter spacing */
    }

    /* Reduce spacing in experience/requirements grid */
    #slide-8 section > div:nth-child(2) {
        gap: 0.3rem !important;  /* Tighter gap between columns */
    }

    #slide-8 section > div:nth-child(2) > div > div:nth-child(2) {
        gap: 0.25rem !important;  /* Tighter gap between items */
    }

    /* Reduce all clamp font sizes for print */
    #slide-8 div[style*="font-size: clamp(0.65rem"] {
        font-size: 0.6rem !important;
    }

    #slide-8 div[style*="font-size: clamp(0.55rem"] {
        font-size: 0.5rem !important;
    }

    #slide-8 div[style*="font-size: clamp(0.6rem"] {
        font-size: 0.55rem !important;
    }

    #slide-8 div[style*="font-size: clamp(0.5rem"] {
        font-size: 0.45rem !important;
    }

    #slide-8 div[style*="font-size: clamp(0.7rem"] {
        font-size: 0.6rem !important;
    }

    #slide-8 div[style*="font-size: clamp(0.75rem"] {
        font-size: 0.65rem !important;
    }

    #slide-8 div[style*="font-size: clamp(0.8rem"] {
        font-size: 0.7rem !important;
    }

    /* Make the three cards more compact */
    #slide-8 .slide-content > div:nth-last-child(2) {
        gap: 0.3rem !important;
    }

    #slide-8 .slide-content > div:nth-last-child(2) > div {
        padding: 0.4rem !important;
    }

    /* Emoji sizes in the three cards */
    #slide-8 div[style*="font-size: clamp(1rem"] {
        font-size: 0.9rem !important;
    }

    #slide-8 div[style*="font-size: clamp(1.25rem"] {
        font-size: 1rem !important;
    }

    #slide-8 div[style*="font-size: clamp(1.5rem"] {
        font-size: 1.1rem !important;
    }

    /* Make the closing statement smaller */
    #slide-8 .slide-content > div:last-child {
        padding: 0.4rem 0.6rem !important;
        flex-shrink: 0 !important;
    }

    #slide-8 .slide-content > div:last-child p {
        font-size: 0.65rem !important;
        line-height: 1.25 !important;
    }

    /* Unique value box - more compact */
    #slide-8 div[style*="background: #f0f7ff"] {
        padding: 0.3rem 0.4rem !important;  /* Tighter vertical padding */
        margin-top: 0.25rem !important;  /* Reduced top margin */
    }

    #slide-8 div[style*="background: #f0f7ff"] div[style*="font-weight: 600"] {
        font-size: 0.55rem !important;  /* Smaller heading */
        margin-bottom: 0.15rem !important;  /* Tighter spacing */
    }

    #slide-8 div[style*="background: #f0f7ff"] ul {
        font-size: 0.48rem !important;  /* Smaller text */
        line-height: 1.15 !important;  /* Tighter line height */
        padding-left: 0.9rem !important;
        margin: 0 !important;
    }

    #slide-8 div[style*="background: #f0f7ff"] ul li {
        margin-bottom: 0.1rem !important;  /* Tighter spacing between items */
    }

    /* Experience and requirement boxes */
    #slide-8 div[style*="background: #f8f9fa"] {
        padding: 0.3rem !important;
    }

    #slide-8 div[style*="background: #f0f0f0"] {
        padding: 0.3rem !important;
    }
}